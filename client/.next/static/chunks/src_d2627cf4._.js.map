{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/pet%20projects/FoodieHub/client/src/utils/iconMapObjects.ts"],"sourcesContent":["import L from \"leaflet\"\r\n\r\n\r\nexport const receiverIcon = new L.Icon({\r\n    iconUrl: \"/my-marker.png\",\r\n    iconSize: [25, 25],\r\n})\r\n\r\nexport const restaurantIcon =\r\n    new L.Icon({\r\n        iconUrl: \"/restaurant.png\",\r\n        iconSize: [25, 25],\r\n    })\r\n\r\nexport const courierIcon  =  new L.Icon({\r\n    iconUrl:\"/courier.png\",\r\n    iconSize:[25,25],\r\n})\r\n\r\n"],"names":[],"mappings":";;;;;AAAA;;AAGO,MAAM,eAAe,IAAI,oJAAA,CAAA,UAAC,CAAC,IAAI,CAAC;IACnC,SAAS;IACT,UAAU;QAAC;QAAI;KAAG;AACtB;AAEO,MAAM,iBACT,IAAI,oJAAA,CAAA,UAAC,CAAC,IAAI,CAAC;IACP,SAAS;IACT,UAAU;QAAC;QAAI;KAAG;AACtB;AAEG,MAAM,cAAgB,IAAI,oJAAA,CAAA,UAAC,CAAC,IAAI,CAAC;IACpC,SAAQ;IACR,UAAS;QAAC;QAAG;KAAG;AACpB","debugId":null}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/pet%20projects/FoodieHub/client/src/components/order/MapTracker.tsx"],"sourcesContent":["\"use client\"\r\nimport { Order } from '@/redux/reduxTypes';\r\nimport { courierIcon, receiverIcon, restaurantIcon } from '@/utils/iconMapObjects';\r\nimport axios from 'axios';\r\nimport { useEffect, useState } from 'react';\r\nimport { MapContainer, Marker, TileLayer } from 'react-leaflet';\r\nimport { io, Socket } from 'socket.io-client';\r\nimport \"leaflet/dist/leaflet.css\";\r\n\r\n\r\nconst MapTracker = ({ isWorking, socket, courierLocation }: { isWorking: Order | null, socket: Socket | null, courierLocation: [number, number] | null }) => {\r\n    const [restaurantLocation, setRestaurantLocation] = useState<[number, number] | null>(null);\r\n    const [receiverLocation, setReceiverLocation] = useState<[number, number] | null>(null);\r\n    const [loadingLocation, setLoadingLocation] = useState<boolean>(true);\r\n\r\n    // connecting to socket room, geocoding receiver adress\r\n\r\n    useEffect(() => {\r\n        if (socket && isWorking) {\r\n            socket.emit(\"joinOrder\", isWorking._id);\r\n            const geoCode = async () => {\r\n                try {\r\n                    await getRestaurentLocation();\r\n                    await getReceiverLocation();\r\n                } catch (err) {\r\n                    console.error(err);\r\n                } finally {\r\n                    setLoadingLocation(false);\r\n\r\n                }\r\n\r\n            }\r\n\r\n            geoCode();\r\n\r\n        }\r\n    }, [socket, isWorking]);\r\n\r\n\r\n\r\n    // geocoding fuuctions -- latitude longitude for marker position on the map\r\n    const getRestaurentLocation = async () => {\r\n        try {\r\n            if (isWorking) {\r\n                const res1 = await axios.get(`http://localhost:5200/api/restaurant/get-restaurant-adress/${isWorking.restaurantTitle}`);\r\n                const adress = res1.data.adress;\r\n                const address = `${adress.street} ${adress.houseNumber}, ${adress.city}`;\r\n                const res2 = await axios.get(`http://localhost:5200/api/geocode?q=${address}`)\r\n\r\n                const lat = res2.data[0].lat;\r\n                const lng = res2.data[0].lon;\r\n                setRestaurantLocation([lat, lng]);\r\n            }\r\n\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n    const getReceiverLocation = async () => {\r\n        try {\r\n            if (isWorking) {\r\n                const address = `${isWorking.adress.street} ${isWorking.adress.houseNumber}, ${isWorking.adress.city}`;\r\n                const res = await fetch(`http://localhost:5200/api/geocode?q=${address}`)\r\n                const data = await res.json();\r\n                console.log(data);\r\n                const lat = data[0].lat;\r\n                const lng = data[0].lon;\r\n                setReceiverLocation([lat, lng]);\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n        } finally {\r\n        }\r\n    }\r\n    if (isWorking?.status === \"Delivered\") {\r\n        return (\r\n            <span>Access denied</span>\r\n        )\r\n    }\r\n    return (<>\r\n\r\n        {\r\n            loadingLocation ? (<div className=\"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500 border-solid mx-auto\"></div>) : courierLocation != null && receiverLocation != null && restaurantLocation != null &&\r\n\r\n                <MapContainer zoom={15} className='h-[150px] w-[150px]' center={receiverLocation} >\r\n\r\n                    <TileLayer attribution='copy& Copyright openStreetMap ' url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png' />\r\n                    <Marker position={receiverLocation} icon={receiverIcon} />\r\n                    <Marker position={restaurantLocation} icon={restaurantIcon} />\r\n                    <Marker position={courierLocation} icon={courierIcon} />\r\n                </MapContainer >\r\n\r\n\r\n        }\r\n\r\n    </>\r\n    )\r\n}\r\n\r\nexport default MapTracker"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 203, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/pet%20projects/FoodieHub/client/src/app/%28main%29/orders/page.tsx"],"sourcesContent":["\"use client\"\r\nimport MapTracker from '@/components/order/MapTracker';\r\nimport OrderCard from '@/components/order/OrderCard';\r\nimport { Order } from '@/redux/reduxTypes'\r\nimport axios from 'axios';\r\nimport { Calendar, ClipboardList, DollarSign, Map, MapPin, User } from 'lucide-react';\r\nimport { useEffect, useState } from 'react'\r\nimport { io, Socket } from 'socket.io-client';\r\n\r\nconst Page = () => {\r\n  const [orders, setOrders] = useState<Order[] | null>();\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const [socket, setSocket] = useState<Socket | null>(null);\r\n  const [viewDetails, setViewDetails] = useState<Order | null>(null);\r\n  const [courierLocation, setCourierLocation] = useState<[number, number] | null>(null);\r\n\r\n  // creating a socket connection\r\n  useEffect(() => {\r\n\r\n    const sock = io(\"http://localhost:5200\");\r\n    setSocket(sock);\r\n\r\n\r\n    return () => { sock.disconnect(); }\r\n\r\n\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!socket) return;\r\n    const handleLocationUpdate = ({ lat, lng }: { lat: number; lng: number }) => {\r\n      setCourierLocation([lat, lng]);\r\n      console.log([lat, lng], \"location\");\r\n    };\r\n\r\n    socket.on(\"locationUpdate\", handleLocationUpdate);\r\n\r\n    return () => {\r\n      socket.off(\"locationUpdate\", handleLocationUpdate);\r\n    };\r\n\r\n\r\n  }, [socket])\r\n\r\n  useEffect(() => {\r\n    const getOrders = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const res = await axios.get(\"http://localhost:5200/api/order/get-orders\", { withCredentials: true });\r\n        if (res) setOrders(res.data);\r\n      } catch (err) {\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    getOrders();\r\n\r\n\r\n\r\n\r\n\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (orders) {\r\n\r\n      const item = orders?.find(order => order.status === \"Preparing\") || orders[0];\r\n      setViewDetails(item);\r\n\r\n    }\r\n\r\n  }, [orders])\r\n  const currentOrders = orders?.filter(order => order.status == \"Delivering\" || order.status == \"Preparing\");\r\n  const pastOrders = orders?.filter(order => order.status == \"Delivered\");\r\n  return (\r\n                  <MapTracker courierLocation={courierLocation} socket={socket} isWorking={viewDetails} />\r\n\r\n  )\r\n}\r\n\r\nexport default Page"],"names":[],"mappings":";;;;AACA;AAGA;AAEA;AACA;AAAA;;;AAPA;;;;;AASA,MAAM,OAAO;;IACX,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAW;IAChD,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IACpD,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAgB;IAC7D,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAA2B;IAEhF,+BAA+B;IAC/B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YAER,MAAM,OAAO,CAAA,GAAA,kLAAA,CAAA,KAAE,AAAD,EAAE;YAChB,UAAU;YAGV;kCAAO;oBAAQ,KAAK,UAAU;gBAAI;;QAGpC;yBAAG,EAAE;IAEL,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACR,IAAI,CAAC,QAAQ;YACb,MAAM;uDAAuB,CAAC,EAAE,GAAG,EAAE,GAAG,EAAgC;oBACtE,mBAAmB;wBAAC;wBAAK;qBAAI;oBAC7B,QAAQ,GAAG,CAAC;wBAAC;wBAAK;qBAAI,EAAE;gBAC1B;;YAEA,OAAO,EAAE,CAAC,kBAAkB;YAE5B;kCAAO;oBACL,OAAO,GAAG,CAAC,kBAAkB;gBAC/B;;QAGF;yBAAG;QAAC;KAAO;IAEX,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACR,MAAM;4CAAY;oBAChB,IAAI;wBACF,WAAW;wBACX,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,8CAA8C;4BAAE,iBAAiB;wBAAK;wBAClG,IAAI,KAAK,UAAU,IAAI,IAAI;oBAC7B,EAAE,OAAO,KAAK;wBACZ,QAAQ,KAAK,CAAC;oBAChB,SAAU;wBACR,WAAW;oBACb;gBACF;;YACA;QAMF;yBAAG,EAAE;IAEL,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACR,IAAI,QAAQ;gBAEV,MAAM,OAAO,QAAQ;sCAAK,CAAA,QAAS,MAAM,MAAM,KAAK;wCAAgB,MAAM,CAAC,EAAE;gBAC7E,eAAe;YAEjB;QAEF;yBAAG;QAAC;KAAO;IACX,MAAM,gBAAgB,QAAQ,OAAO,CAAA,QAAS,MAAM,MAAM,IAAI,gBAAgB,MAAM,MAAM,IAAI;IAC9F,MAAM,aAAa,QAAQ,OAAO,CAAA,QAAS,MAAM,MAAM,IAAI;IAC3D,qBACgB,6LAAC,4IAAA,CAAA,UAAU;QAAC,iBAAiB;QAAiB,QAAQ;QAAQ,WAAW;;;;;;AAG3F;GAtEM;KAAA;uCAwES","debugId":null}}]
}